(this["webpackJsonpcesium-demo"]=this["webpackJsonpcesium-demo"]||[]).push([[14],{401:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var i=n(49),s=n(50),r=(n(10),n(123)),o=n.n(r),a=n(195),u=n.n(a),c=n(995),l=n(23),p=function(){function e(t,n,s){Object(i.a)(this,e),this.viewer=t,this.cesium=n,this.extensionName="Measurement/measureTools/LengthGround",this.ids=[],this.coms=[],this.options=s,this.isRunning=!0}return Object(s.a)(e,[{key:"getGuid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xxxxxxxxxx",t=(new Date).getTime(),n=e.replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:7&n|8).toString(16)}));return n}},{key:"create",value:function(){var e=this,t=u()("#cesiumContainer")[0],n=this.getGuid(),i="<div id=".concat(n,"></div>");u()(t).append(i);var s=o.a.render(Object(l.jsx)(c.a,{viewer:this.viewer,options:this.options}),document.getElementById(n));s.stateChange.addEventListener((function(t){e.isRunning=t})),this.ids.push(n),this.coms.push(s)}},{key:"load",value:function(){return!0}},{key:"unload",value:function(){return this.ids.forEach((function(e){o.a.unmountComponentAtNode(document.getElementById(e)),u()("#"+e).remove()})),this.viewer.modes[this.extensionName]=null,!0}}]),e}()},456:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return u}));var i,s,r=n(49),o=n(50);function a(e,t){return e.entities.add({position:t,point:{pixelSize:5,color:Cesium.Color.WHITE,outlineColor:Cesium.Color.DEEPPINK,outlineWidth:2,disableDepthTestDistance:Number.POSITIVE_INFINITY}})}!function(e){e.POINT="\u70b9\u6d4b\u91cf",e.LINE="\u7ebf\u6bb5\u6d4b\u91cf",e.VOLUME="\u4f53\u79ef\u6d4b\u91cf",e.AREA="\u9762\u79ef\u6d4b\u91cf"}(i||(i={})),function(e){e.WAITING="\u7b49\u5f85\u4e2d",e.SAMPLING="\u91c7\u6837\u4e2d",e.COMPUING="\u8ba1\u7b97\u4e2d",e.FINISHED="\u6d4b\u91cf\u7ed3\u675f"}(s||(s={}));var u=function(){function e(t){var n=this;Object(r.a)(this,e),this.type=void 0,this.currentMeasure=void 0,this.handler=void 0,this._beActived=!1,this.viewer=void 0,this.addSamplePoint=function(e){var t=function(e,t){var n=e.camera.getPickRay(t),i=e.scene.pickFromRay(n,[]);return i&&null!=i.position?e.scene.clampToHeight(i.position):null}(n.viewer,e);return null!=t?{ins:a(n.viewer,t),pos:t}:null},this.active=function(){n.beActived=!0,n.onStateChange.raiseEvent(n.beActived)},this.onSampleChange=new Cesium.Event,this.onStateChange=new Cesium.Event,this.onEndMeasure=new Cesium.Event,this.viewer=t,this.createEventHandler()}return Object(o.a)(e,[{key:"beActived",get:function(){return this._beActived},set:function(e){this._beActived=e,this.onStateChange.raiseEvent(e)}},{key:"disActive",value:function(){this.beActived=!1,this.onStateChange.raiseEvent(this.beActived),this.currentMeasure.dispose(this.viewer),this.currentMeasure=void 0}}]),e}()},486:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(514),s=n(49),r=n(50),o=n(52),a=n(51),u=n(10),c=n.n(u),l=(n(487),n(23)),p=function(e){Object(o.a)(n,e);var t=Object(a.a)(n);function n(e){var i;(Object(s.a)(this,n),(i=t.call(this,e)).element=void 0,i.mousePos=void 0,i.onUpdate=function(){if(null!=i.element){var e;if(i.props.trackCursor)e=i.mousePos;else if(i.props.trackEntity){var t=i.props.trackEntity.position.getValue(Cesium.JulianDate.now());e=Cesium.SceneTransforms.wgs84ToWindowCoordinates(i.props.viewer.scene,t)}else i.props.trackPos&&(e=Cesium.SceneTransforms.wgs84ToWindowCoordinates(i.props.viewer.scene,i.props.trackPos));if(e){switch(i.element.style.display="",i.props.alignX){case"left":i.element.style.left=e.x+"px";break;case"center":i.element.style.left=e.x+.5*i.element.clientWidth+"px";break;case"right":default:i.element.style.left=e.x-.5*i.element.clientWidth+"px"}switch(i.props.alignY){case"top":i.element.style.top=e.y-i.element.clientHeight+"px";break;case"bottom":i.element.style.top=e.y+"px";break;case"center":default:i.element.style.top=e.y-.5*i.element.clientHeight+"px"}}else i.element.style.display="none"}},e.trackCursor)&&(new Cesium.ScreenSpaceEventHandler).setInputAction((function(e){var t=i.props.viewer.container.getBoundingClientRect();i.mousePos=Cesium.Cartesian2.subtract(e.endPosition,new Cesium.Cartesian2(t.left,t.top),new Cesium.Cartesian2)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE);return i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){this.props.viewer.scene.preUpdate.addEventListener(this.onUpdate)}},{key:"componentWillUnmount",value:function(){this.props.viewer&&!this.props.viewer.isDestroyed()&&this.props.viewer.scene.preUpdate.removeEventListener(this.onUpdate)}},{key:"render",value:function(){var e=this;return Object(l.jsxs)("div",{className:"cesium-tag",ref:function(t){return e.element=t},style:Object(i.a)({},this.props.textCss),children:[this.props.text,this.props.children]})}}]),n}(c.a.Component)},487:function(e,t,n){},488:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i,s=n(49),r=n(50),o=n(52),a=n(51),u=n(10),c=n.n(u),l=(n(489),n(23));!function(e){e.LEFT="left",e.BOTTOM="bottom"}(i||(i={}));var p=function(e){Object(o.a)(n,e);var t=Object(a.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e;return Object(l.jsx)("div",{className:"chat-frame ".concat(null!==(e=this.props.location)&&void 0!==e?e:"left"),children:Object(l.jsx)("span",{children:this.props.text})})}}]),n}(c.a.Component)},489:function(e,t,n){},490:function(e,t,n){},508:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));n(509);var i=n(537);function s(e){var t=[];e.map((function(e){t.push([e.lng,e.lat])}));var n=i.polygon([t]);return i.area(n)}function r(e,t){if(e&&t){var n=e.scene.camera.getPickRay(t),i=e.scene.globe.pick(n,e.scene);if(void 0==e.scene.pick(t)&&i){var s=Cesium.Ellipsoid.WGS84.cartesianToCartographic(i),r=Cesium.Math.toDegrees(s.longitude),o=Cesium.Math.toDegrees(s.latitude),a=e.scene.globe.getHeight(s),u=parseFloat(a.toFixed(2));return Cesium.Cartesian3.fromDegrees(r,o,u)}var c=e.scene.pickPosition(t);return Cesium.defined(c)?c:null}}function o(e){return e?e.map((function(e){return function(e){var t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(e);return{lng:Cesium.Math.toDegrees(t.longitude),lat:Cesium.Math.toDegrees(t.latitude),alt:t.height}}(e)})):[]}function a(e){return e?Cesium.Cartographic.fromDegrees(e.lng,e.lat,e.alt):Cesium.Cartographic.ZERO}function u(e){for(var t=0,n=0;n<e.length-1;n++){var i=a(e[n]),s=a(e[n+1]),r=new Cesium.EllipsoidGeodesic;r.setEndPoints(i,s);var o=r.surfaceDistance;t+=o=Math.sqrt(Math.pow(o,2)+Math.pow(s.height-i.height,2))}return parseFloat(t.toFixed(3))}function c(e,t){if(e&&t){var n=e.scene.camera.getPickRay(t),i=e.scene.globe.pick(n,e.scene);if(void 0==e.scene.pick(t)&&i){var s=Cesium.Ellipsoid.WGS84.cartesianToCartographic(i),r=Cesium.Math.toDegrees(s.longitude),o=Cesium.Math.toDegrees(s.latitude),a=e.scene.globe.getHeight(s);return{degree:{lng:r,lat:o,alt:c=a||0},cartesian3:Cesium.Cartesian3.fromDegrees(r,o,c)}}var u=e.scene.pickPosition(t);if(Cesium.defined(u)){var c,l=Cesium.Cartographic.fromCartesian(u);return{degree:{lng:r=Cesium.Math.toDegrees(l.longitude),lat:o=Cesium.Math.toDegrees(l.latitude),alt:c=l.height},cartesian3:Cesium.Cartesian3.fromDegrees(r,o,c)}}}return null}function l(e,t,n){return new Cesium.Cartesian3((t.x+n.x)/2,(t.y+n.y)/2,(t.z+n.z)/2)}},995:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n(509),s=n(49),r=n(50),o=n(52),a=n(51),u=n(10),c=n.n(u),l=n(486),p=n(488),h=(n(490),n(508)),d=n(456),v=n(23),m=function(e){Object(o.a)(n,e);var t=Object(a.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).positions=void 0,i.markPointsEntity=void 0,i._lineEntity=void 0,i._handlers=void 0,i._labelEntity=void 0,i._labelPoint=void 0,i._label=void 0,i.stateChange=void 0,i.curLineEntity=void 0,i.curLabel=void 0,i.state={tagText:null,tagState:0,showTag:!0},i._addInfoPoint=function(e){i._labelPoint.push(e.clone()),i._label.push((Object(h.d)(Object(h.f)(i.positions))/1).toFixed(4)+"\u7c73")},i.positions=[],i.markPointsEntity=[],i._labelPoint=[],i._label=[],i._lineEntity=[],i._handlers=new Cesium.ScreenSpaceEventHandler(i.props.viewer.scene.canvas),i.stateChange=new Cesium.Event,i.curLineEntity=null,i.curLabel="",i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({tagText:"\u5de6\u5355\u51fb-\u5f00\u59cb\u7ed8\u5236",tagState:0}),this._handlers.setInputAction((function(t){var n=Object(h.a)(e.props.viewer,t.position);n&&(e.positions.length<2&&(e.setState({tagText:"\u5de6\u5355\u51fb-\u589e\u52a0\u70b9",tagState:1}),e.positions.push(n),e.markPointsEntity.push(Object(d.d)(e.props.viewer,n))),e.positions.length,2==e.positions.length&&(e.curLineEntity.polyline.positions=new Cesium.ConstantProperty(Object(i.a)(e.positions)),e._addInfoPoint(e.positions[1]),e.positions.shift(),e.setState({tagText:"\u5de6\u5355\u51fb-\u589e\u52a0\u70b9 \u53f3\u5355\u51fb\u7ed3\u675f\u7ed8\u5236",tagState:2})))}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this._handlers.setInputAction((function(t){2==e.state.tagState&&(e._handlers.destroy(),e._handlers=null,e.curLineEntity&&e.props.viewer.entities.remove(e.curLineEntity),e.setState({showTag:!1}),e.stateChange.raiseEvent(!1))}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),this._handlers.setInputAction((function(t){if(0!=e.state.tagState){var n=Object(h.a)(e.props.viewer,t.endPosition);if(1==e.positions.length){if(n&&n.x){e.positions.push(n),e.curLineEntity=new Cesium.Entity,e.curLineEntity.polyline=new Cesium.PolylineGraphics({width:e.props.options.width||5,material:Cesium.Color.BLUE.withAlpha(.8),clampToGround:e.props.options.clampToGround||!1}),e.curLineEntity.polyline.positions=new Cesium.CallbackProperty((function(t){return e.positions}),!1);var i=e.props.viewer.entities.add(e.curLineEntity);e._lineEntity.push(i)}}else n&&n.x&&(e.positions.pop(),e.positions.push(n));e.curLabel=(Object(h.d)(Object(h.f)(e.positions))/1).toFixed(4)+"\u7c73",1==e.state.tagState&&e.setState({tagText:"\u5de6\u5355\u51fb-\u589e\u52a0\u70b9\n"+e.curLabel}),2==e.state.tagState&&e.setState({tagText:"\u5de6\u5355\u51fb-\u589e\u52a0\u70b9 \u53f3\u5355\u51fb\u7ed3\u675f\u7ed8\u5236\n"+e.curLabel})}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)}},{key:"componentWillUnmount",value:function(){var e=this;this._handlers&&(this._handlers.destroy(),this._handlers=null),this._lineEntity.forEach((function(t){return e.props.viewer.entities.remove(t)})),this.props.viewer.entities.remove(this._labelEntity),this.markPointsEntity.forEach((function(t){return e.props.viewer.entities.remove(t)}))}},{key:"render",value:function(){var e=this,t=this.state,n=(t.tagText,t.showTag);return Object(v.jsxs)(c.a.Fragment,{children:[n?Object(v.jsx)(l.a,{viewer:this.props.viewer,trackCursor:!0,alignX:"left",alignY:"center",children:Object(v.jsx)(p.a,{text:this.state.tagText})}):null,this._labelPoint.map((function(t,n){return Object(v.jsx)(l.a,{viewer:e.props.viewer,trackPos:t,alignX:"left",alignY:"center",children:Object(v.jsx)(p.a,{text:e._label[n]})},n)}))]})}}]),n}(c.a.Component)}}]);