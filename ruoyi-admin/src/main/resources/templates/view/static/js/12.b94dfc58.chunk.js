(this["webpackJsonpcesium-demo"]=this["webpackJsonpcesium-demo"]||[]).push([[12],{411:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return j}));var n=i(49),s=i(50),o=i(10),a=i.n(o),r=i(123),l=i.n(r),u=i(195),c=i.n(u),h=(i(1125),i(1135)),p=i(509),d=i(52),m=i(51),v=i(486),g=i(488),f=(i(490),i(508)),b=i(456),C=i(534),w=i(686),y=i(23),x=function(e){Object(d.a)(i,e);var t=Object(m.a)(i);function i(e){var s;return Object(n.a)(this,i),(s=t.call(this,e)).custompanel=void 0,s.markPointsEntity=void 0,s.points=void 0,s._positions=void 0,s._lineEntity=void 0,s._handlers=void 0,s.stateChange=void 0,s.isCompressHeight=void 0,s.isHeight=void 0,s.ptsAry=void 0,s.resultPoints=void 0,s.maxHeight=void 0,s.movedPoint=void 0,s.state={tagText:null,_label:null,_labelPoint:null,showTag:!0,showPanel:!1},s._addInfoPoint=function(e){s._positions.push(e);s.props.viewer.scene.globe.ellipsoid;var t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(e),i=Cesium.Math.toDegrees(t.longitude),n=Cesium.Math.toDegrees(t.latitude);s.points.push({lgtd:i,lttd:n}),s.markPointsEntity.push(Object(b.d)(s.props.viewer,e))},s.getData=function(e){s.resultPoints=s.makeChange(e,s.props.options),s.ptsAry=[];for(var t=[],i=[],n=0;n<s.resultPoints.length;n++){var o=s.resultPoints[n];s.maxHeight<o.degree.alt&&(s.maxHeight=o.degree.alt),s.ptsAry.push(Number(o.degree.lng)),s.ptsAry.push(Number(o.degree.lat)),s.ptsAry.push(Number(o.degree.alt)),t.push(Number(o.degree.lng)),i.push(Number(o.degree.lat))}s._lineEntity.polyline=new Cesium.PolylineGraphics({width:s.props.options.width||5,material:Cesium.Color.BLUE.withAlpha(.8),clampToGround:s.props.options.clampToGround||!0}),s._lineEntity.polyline.positions=new Cesium.CallbackProperty((function(){return s._positions}),!1),s.props.viewer.entities.add(s._lineEntity),s.custompanel&&(s.custompanel.setVisible(!1),s.custompanel=null),s.setState({showPanel:!0})},s.setRange=function(e){s.isCompressHeight=e.target.checked,s.setState({})},s.getCompressHeight=function(e){return s.isCompressHeight},s.deactivate=function(){s.custompanel&&(s.custompanel.setVisible(!1),s.custompanel=null),s.props.close()},s.createHundryPoints=function(e){for(var t=e[0].lgtd,i=(e[1].lgtd-t)/1e3,n=e[0].lttd,s=(e[1].lttd-n)/1e3,o=[],a=0;a<1e3;a++){var r=t+i*a,l=n+s*a;o.push({id:a,lgtd:r,lttd:l})}return o},s.makeChange=function(e){var t=[],i=Object(p.a)(e),n=s.props.options.pointCount||100;if(2==i.length)for(var o=i[0],a=i[1],r=(n=100,0);r<=n;++r){var l=r/n,u=Cesium.Cartesian3.lerp(o,a,l,new Cesium.Cartesian3),c=s.props.viewer.scene.clampToHeight(u),h=Cesium.Cartographic.fromCartesian(c),d={degree:{lng:Cesium.Math.toDegrees(h.longitude),lat:Cesium.Math.toDegrees(h.latitude),alt:h.height},cartesian3:c};t.push(d)}return t},s.setVisible=function(e){s.setState({showPanel:e})},s.setHeight=function(e){s.isHeight=e.target.checked,s.setState({})},s.drawPoint=function(e,t){var i=Cesium.Cartesian3.subtract(s._positions[1],s._positions[0],new Cesium.Cartesian3),n=Cesium.Cartesian3.multiplyByScalar(i,e/t,new Cesium.Cartesian3),o=Cesium.Cartesian3.add(n,s._positions[0],new Cesium.Cartesian3),a=s.props.viewer.scene.clampToHeight(o);s.movedPoint.forEach((function(e){return s.props.viewer.entities.remove(e)})),s.movedPoint.push(s.props.viewer.entities.add({position:a,billboard:{image:"/Images/measure_imgs/locator.png",color:Cesium.Color.RED,disableDepthTestDistance:Number.POSITIVE_INFINITY,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.CENTER}}))},s._positions=[],s.points=[],s._lineEntity=new Cesium.Entity,s.markPointsEntity=[],s._handlers=new Cesium.ScreenSpaceEventHandler(s.props.viewer.scene.canvas),s.stateChange=new Cesium.Event,s.isCompressHeight=!1,s.isHeight=!1,s.maxHeight=0,s.movedPoint=[],s}return Object(s.a)(i,[{key:"componentDidMount",value:function(){var e=this;this.setState({tagText:"\u5de6\u5355\u51fb-\u5f00\u59cb\u7ed8\u5236"}),this._handlers.setInputAction((function(t){var i=Object(f.b)(e.props.viewer,t.position);if(i&&i.cartesian3&&(e._addInfoPoint(i.cartesian3),1==e.points.length&&e.setState({tagText:"\u5de6\u5355\u51fb-\u7ed3\u675f\u70b9"}),2==e.points.length))return e._handlers.destroy(),e._handlers=null,e.setState({tagText:"\u5f00\u59cb\u8ba1\u7b97"}),e.getData(e._positions),e.setState({showTag:!1}),void e.stateChange.raiseEvent(!1)}),Cesium.ScreenSpaceEventType.LEFT_CLICK)}},{key:"componentWillUnmount",value:function(){var e=this;this.custompanel&&(this.custompanel.setVisible(!1),this.custompanel=null),this._handlers&&(this._handlers.destroy(),this._handlers=null),this.props.viewer.entities.remove(this._lineEntity),this.markPointsEntity.forEach((function(t){return e.props.viewer.entities.remove(t)})),this.movedPoint.forEach((function(t){return e.props.viewer.entities.remove(t)}))}},{key:"render",value:function(){var e=this.state,t=(e.tagText,e.showTag),i=e.showPanel;return Object(y.jsxs)(a.a.Fragment,{children:[t?Object(y.jsx)(v.a,{viewer:this.props.viewer,trackCursor:!0,alignX:"left",alignY:"center",children:Object(y.jsx)(g.a,{text:this.state.tagText})}):null,this.state._labelPoint?Object(y.jsx)(v.a,{viewer:this.props.viewer,trackPos:this.state._labelPoint,alignX:"left",alignY:"center",children:Object(y.jsx)(g.a,{text:this.state._label})}):Object(y.jsx)(y.Fragment,{}),i?Object(y.jsx)(C.a,{content:Object(y.jsx)(w.a,{drawPoint:this.drawPoint,isHeight:this.isHeight,getCompressHeight:this.getCompressHeight,Cesium:Cesium,data:{list:this.ptsAry,oList:this.resultPoints,maxHeight:this.maxHeight}}),title:Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("span",{style:{paddingRight:50,fontWeight:"bold"},children:"\u5730\u5f62\u5256\u9762\u56fe"}),Object(y.jsx)(h.a,{style:{color:"white"},defaultChecked:!1,onChange:this.setRange,children:"\u9ad8\u5ea6\u538b\u7f29"}),Object(y.jsx)(h.a,{style:{color:"white"},defaultChecked:!1,onChange:this.setHeight,children:"\u76f8\u5bf9\u9ad8\u5ea6"})]}),setVisible:this.deactivate,height:365,width:557}):Object(y.jsx)(y.Fragment,{})]})}}]),i}(a.a.Component),j=function(){function e(t,i,s){Object(n.a)(this,e),this.viewer=t,this.cesium=i,this.extensionName="Measurement/measureTools/SectionAnalysis",this.id=this.getGuid(),this.com=null,this.options=s,this.close=this.close.bind(this),this.isRunning=!0}return Object(s.a)(e,[{key:"getGuid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xxxxxxxxxx",t=(new Date).getTime(),i=e.replace(/[xy]/g,(function(e){var i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:7&i|8).toString(16)}));return i}},{key:"close",value:function(){this.unload()}},{key:"load",value:function(){var e=this,t=c()("#cesiumContainer")[0],i="<div id=".concat(this.id,"></div>");return c()(t).append(i),this.com=l.a.render(Object(y.jsx)(x,{close:this.close,viewer:this.viewer,options:this.options}),document.getElementById(this.id)),this.com.stateChange.addEventListener((function(t){return e.isRunning=t})),!0}},{key:"unload",value:function(){return l.a.unmountComponentAtNode(document.getElementById(this.id)),c()("#"+this.id).remove(),this.viewer.modes[this.extensionName]=null,!0}}]),e}()},456:function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"a",(function(){return l}));var n,s,o=i(49),a=i(50);function r(e,t){return e.entities.add({position:t,point:{pixelSize:5,color:Cesium.Color.WHITE,outlineColor:Cesium.Color.DEEPPINK,outlineWidth:2,disableDepthTestDistance:Number.POSITIVE_INFINITY}})}!function(e){e.POINT="\u70b9\u6d4b\u91cf",e.LINE="\u7ebf\u6bb5\u6d4b\u91cf",e.VOLUME="\u4f53\u79ef\u6d4b\u91cf",e.AREA="\u9762\u79ef\u6d4b\u91cf"}(n||(n={})),function(e){e.WAITING="\u7b49\u5f85\u4e2d",e.SAMPLING="\u91c7\u6837\u4e2d",e.COMPUING="\u8ba1\u7b97\u4e2d",e.FINISHED="\u6d4b\u91cf\u7ed3\u675f"}(s||(s={}));var l=function(){function e(t){var i=this;Object(o.a)(this,e),this.type=void 0,this.currentMeasure=void 0,this.handler=void 0,this._beActived=!1,this.viewer=void 0,this.addSamplePoint=function(e){var t=function(e,t){var i=e.camera.getPickRay(t),n=e.scene.pickFromRay(i,[]);return n&&null!=n.position?e.scene.clampToHeight(n.position):null}(i.viewer,e);return null!=t?{ins:r(i.viewer,t),pos:t}:null},this.active=function(){i.beActived=!0,i.onStateChange.raiseEvent(i.beActived)},this.onSampleChange=new Cesium.Event,this.onStateChange=new Cesium.Event,this.onEndMeasure=new Cesium.Event,this.viewer=t,this.createEventHandler()}return Object(a.a)(e,[{key:"beActived",get:function(){return this._beActived},set:function(e){this._beActived=e,this.onStateChange.raiseEvent(e)}},{key:"disActive",value:function(){this.beActived=!1,this.onStateChange.raiseEvent(this.beActived),this.currentMeasure.dispose(this.viewer),this.currentMeasure=void 0}}]),e}()},486:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i(514),s=i(49),o=i(50),a=i(52),r=i(51),l=i(10),u=i.n(l),c=(i(487),i(23)),h=function(e){Object(a.a)(i,e);var t=Object(r.a)(i);function i(e){var n;(Object(s.a)(this,i),(n=t.call(this,e)).element=void 0,n.mousePos=void 0,n.onUpdate=function(){if(null!=n.element){var e;if(n.props.trackCursor)e=n.mousePos;else if(n.props.trackEntity){var t=n.props.trackEntity.position.getValue(Cesium.JulianDate.now());e=Cesium.SceneTransforms.wgs84ToWindowCoordinates(n.props.viewer.scene,t)}else n.props.trackPos&&(e=Cesium.SceneTransforms.wgs84ToWindowCoordinates(n.props.viewer.scene,n.props.trackPos));if(e){switch(n.element.style.display="",n.props.alignX){case"left":n.element.style.left=e.x+"px";break;case"center":n.element.style.left=e.x+.5*n.element.clientWidth+"px";break;case"right":default:n.element.style.left=e.x-.5*n.element.clientWidth+"px"}switch(n.props.alignY){case"top":n.element.style.top=e.y-n.element.clientHeight+"px";break;case"bottom":n.element.style.top=e.y+"px";break;case"center":default:n.element.style.top=e.y-.5*n.element.clientHeight+"px"}}else n.element.style.display="none"}},e.trackCursor)&&(new Cesium.ScreenSpaceEventHandler).setInputAction((function(e){var t=n.props.viewer.container.getBoundingClientRect();n.mousePos=Cesium.Cartesian2.subtract(e.endPosition,new Cesium.Cartesian2(t.left,t.top),new Cesium.Cartesian2)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE);return n}return Object(o.a)(i,[{key:"componentDidMount",value:function(){this.props.viewer.scene.preUpdate.addEventListener(this.onUpdate)}},{key:"componentWillUnmount",value:function(){this.props.viewer&&!this.props.viewer.isDestroyed()&&this.props.viewer.scene.preUpdate.removeEventListener(this.onUpdate)}},{key:"render",value:function(){var e=this;return Object(c.jsxs)("div",{className:"cesium-tag",ref:function(t){return e.element=t},style:Object(n.a)({},this.props.textCss),children:[this.props.text,this.props.children]})}}]),i}(u.a.Component)},487:function(e,t,i){},488:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n,s=i(49),o=i(50),a=i(52),r=i(51),l=i(10),u=i.n(l),c=(i(489),i(23));!function(e){e.LEFT="left",e.BOTTOM="bottom"}(n||(n={}));var h=function(e){Object(a.a)(i,e);var t=Object(r.a)(i);function i(){return Object(s.a)(this,i),t.apply(this,arguments)}return Object(o.a)(i,[{key:"render",value:function(){var e;return Object(c.jsx)("div",{className:"chat-frame ".concat(null!==(e=this.props.location)&&void 0!==e?e:"left"),children:Object(c.jsx)("span",{children:this.props.text})})}}]),i}(u.a.Component)},489:function(e,t,i){},490:function(e,t,i){},508:function(e,t,i){"use strict";i.d(t,"e",(function(){return s})),i.d(t,"a",(function(){return o})),i.d(t,"f",(function(){return a})),i.d(t,"d",(function(){return l})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return c}));i(509);var n=i(537);function s(e){var t=[];e.map((function(e){t.push([e.lng,e.lat])}));var i=n.polygon([t]);return n.area(i)}function o(e,t){if(e&&t){var i=e.scene.camera.getPickRay(t),n=e.scene.globe.pick(i,e.scene);if(void 0==e.scene.pick(t)&&n){var s=Cesium.Ellipsoid.WGS84.cartesianToCartographic(n),o=Cesium.Math.toDegrees(s.longitude),a=Cesium.Math.toDegrees(s.latitude),r=e.scene.globe.getHeight(s),l=parseFloat(r.toFixed(2));return Cesium.Cartesian3.fromDegrees(o,a,l)}var u=e.scene.pickPosition(t);return Cesium.defined(u)?u:null}}function a(e){return e?e.map((function(e){return function(e){var t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(e);return{lng:Cesium.Math.toDegrees(t.longitude),lat:Cesium.Math.toDegrees(t.latitude),alt:t.height}}(e)})):[]}function r(e){return e?Cesium.Cartographic.fromDegrees(e.lng,e.lat,e.alt):Cesium.Cartographic.ZERO}function l(e){for(var t=0,i=0;i<e.length-1;i++){var n=r(e[i]),s=r(e[i+1]),o=new Cesium.EllipsoidGeodesic;o.setEndPoints(n,s);var a=o.surfaceDistance;t+=a=Math.sqrt(Math.pow(a,2)+Math.pow(s.height-n.height,2))}return parseFloat(t.toFixed(3))}function u(e,t){if(e&&t){var i=e.scene.camera.getPickRay(t),n=e.scene.globe.pick(i,e.scene);if(void 0==e.scene.pick(t)&&n){var s=Cesium.Ellipsoid.WGS84.cartesianToCartographic(n),o=Cesium.Math.toDegrees(s.longitude),a=Cesium.Math.toDegrees(s.latitude),r=e.scene.globe.getHeight(s);return{degree:{lng:o,lat:a,alt:u=r||0},cartesian3:Cesium.Cartesian3.fromDegrees(o,a,u)}}var l=e.scene.pickPosition(t);if(Cesium.defined(l)){var u,c=Cesium.Cartographic.fromCartesian(l);return{degree:{lng:o=Cesium.Math.toDegrees(c.longitude),lat:a=Cesium.Math.toDegrees(c.latitude),alt:u=c.height},cartesian3:Cesium.Cartesian3.fromDegrees(o,a,u)}}}return null}function c(e,t,i){return new Cesium.Cartesian3((t.x+i.x)/2,(t.y+i.y)/2,(t.z+i.z)/2)}},534:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(49),s=i(50),o=i(71),a=i(52),r=i(51),l=i(10),u=(i(535),i(23)),c=function(e){Object(a.a)(i,e);var t=Object(r.a)(i);function i(e){var s;return Object(n.a)(this,i),(s=t.call(this,e)).state={translateX:0,translateY:0,height:s.props.height,width:s.props.width},s.moving=!1,s.resizemoving=!1,s.lastX=null,s.lastY=null,s.onMouseUp=s.onMouseUp.bind(Object(o.a)(s)),s.onMouseMove=s.onMouseMove.bind(Object(o.a)(s)),window.addEventListener("mouseup",s.onMouseUp),window.addEventListener("mousemove",s.onMouseMove),s}return Object(s.a)(i,[{key:"onMouseDown",value:function(e){e.stopPropagation(),this.moving=!0}},{key:"onResizeMouseDown",value:function(e){e.stopPropagation(),this.resizemoving=!0}},{key:"onMouseUp",value:function(){this.moving=!1,this.resizemoving=!1,this.lastX=null,this.lastY=null}},{key:"onMouseMove",value:function(e){this.moving&&this.onMove(e),this.resizemoving&&this.onResizeMove(e)}},{key:"onResizeMove",value:function(e){if(this.lastX&&this.lastY&&this.lastY>3&&this.lastX>3&&this.lastY<window.innerHeight-10&&this.lastX<window.innerWidth-10){var t=e.clientX-this.lastX,i=e.clientY-this.lastY;this.setState({width:this.state.width+t,height:this.state.height+i})}this.lastX=e.clientX,this.lastY=e.clientY}},{key:"onMove",value:function(e){if(this.lastX&&this.lastY&&this.lastY>3&&this.lastX>3&&this.lastY<window.innerHeight-10&&this.lastX<window.innerWidth-10){var t=e.clientX-this.lastX,i=e.clientY-this.lastY;this.setState({translateX:this.state.translateX+t,translateY:this.state.translateY+i})}this.lastX=e.clientX,this.lastY=e.clientY}},{key:"render",value:function(){var e=this;return Object(u.jsxs)("div",{className:"bf-panel bf-has-title bf-sizable",id:"bf-basepanel",style:{transform:"translateX(".concat(this.state.translateX,"px)translateY(").concat(this.state.translateY,"px)"),left:"calc(50% - "+this.state.width/2+"px",top:"calc(50% - "+this.state.height/2+"px",minWidth:"200px",minHeight:"160px",width:this.state.width+"px",height:this.state.height+"px",overflow:"visible"},children:[Object(u.jsx)("div",{className:"bf-close",onClick:function(t){window.removeEventListener("mouseup",e.onMouseUp),window.removeEventListener("mousemove",e.onMouseMove),e.props.setVisible(!1)}}),Object(u.jsxs)("div",{className:"bf-title",onMouseDown:function(t){return e.onMouseDown(t)},style:{cursor:"move",userSelect:"none"},children:[" ",this.props.title]}),Object(u.jsx)("div",{className:"bf-panel-body",style:{paddingTop:"0px"},children:this.props.content}),Object(u.jsx)("div",{className:"bf-resize",onMouseDown:function(t){return e.onResizeMouseDown(t)}})]})}}]),i}(l.Component)},535:function(e,t,i){},686:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i(49),s=i(50),o=i(52),a=i(51),r=i(10),l=i.n(r),u=i(997),c=i(582),h=i(23),p=[];function d(e,t){t=t||1;try{e=e.toString().replace(/\$|\,/g,""),isNaN(e)&&(e="0")}catch(s){return""}var i=e==(e=Math.abs(e)),n=null;return null==e||"undefined"==typeof e?"":(i?"":"-")+(n=(n=parseFloat(e)/t)>0&&n<1?n.toPrecision(2):n>=1&&n<100||n>=100&&n<=1e3?Number(n.toPrecision(3)):(n+="").split(".")[0])}function m(e){return e*Math.PI/180}function v(e,t,i,n){p=[];var s=[],o=0,a=0,r=e.oList.length;a=function(e,t,i,n){var s=m(e),o=m(i),a=s-o,r=m(t)-m(n),l=2*Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2)+Math.cos(s)*Math.cos(o)*Math.pow(Math.sin(r/2),2)));return l*=6378.137,Math.round(1e4*l)/10}(e.oList[0].degree.lat,e.oList[0].degree.lng,e.oList[r-1].degree.lat,e.oList[r-1].degree.lng)/99,a=Number(d(a));for(var l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,h=2;h<e.list.length;h+=3){var v=e.list[h],g=parseFloat(v);g<l&&(l=g),g>u&&(u=g)}for(h=2;h<e.list.length;h++){var f=e.list[h],b=parseFloat(f.toFixed(2));i&&(b-=l),s.push(b),2==h?p.push(0):(o+=a,p.push(d(o))),h++,h++}var C=Math.ceil(e.maxHeight);return i&&(C=Math.ceil(u-l)),{title:{x:"center",text:"\u5256\u9762\u56fe(m)",textStyle:{fontSize:14,fontWeight:"bolder",color:"white"},subtextStyle:{fontSize:10}},tooltip:{trigger:"axis",formatter:n},dataZoom:{show:!1,realtime:!1,start:0,end:100},grid:{y2:25,y:25,x2:50,x:50},calculable:!0,xAxis:[{type:"category",data:p,name:"m",axisLabel:{color:"white"},axisLine:{lineStyle:{color:"white"}}}],yAxis:{type:"value",scale:!0,max:C=t?C:C+50,min:i?"0":"dataMin",boundaryGap:[0,"100%"],axisLabel:{color:"white"},axisLine:{lineStyle:{color:"white"}}},series:[{name:"\u9ad8\u7a0b",type:"line",smooth:!0,symbol:"none",itemStyle:{normal:{color:"rgb(255, 70, 131)"}},areaStyle:{normal:{color:new c.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])}},data:s}]}}var g=function(e){Object(o.a)(i,e);var t=Object(a.a)(i);function i(){var e;Object(n.a)(this,i);for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).mousemove=function(t){var i="".concat(t[0].axisValue,"<br>").concat(t[0].marker).concat(t[0].seriesName).concat(t[0].value),n=parseFloat(t[0].axisValue),s=p[p.length-1];return e.props.drawPoint(n,s),i},e}return Object(s.a)(i,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.data,i=e.getCompressHeight,n=e.isHeight,s=v(t,i(),n,this.mousemove);return Object(h.jsx)(h.Fragment,{children:null===s?Object(h.jsx)(h.Fragment,{}):Object(h.jsx)(u.a,{option:s})})}}]),i}(l.a.Component)}}]);