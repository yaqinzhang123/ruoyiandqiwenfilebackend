(this["webpackJsonpcesium-demo"]=this["webpackJsonpcesium-demo"]||[]).push([[21],{1044:function(e,t,n){},1045:function(e,t,n){"use strict";(function(e){var t=n(49),i=n(52),o=n(51),r=n(10),c=(n(675),function(){return{Accept:"application/json","Content-Type":"application/json",Authorization:"BasicAuth "+e.Value.Token}}),s=function(e){return function(t){if(t){var n=[];Object.keys(t).forEach((function(e){return n.push(e+"="+encodeURIComponent(t[e]))})),-1===e.search(/\?/)?t="object"===typeof t?e+="?"+n.join("&"):e:e+="&"+n.join("&")}return e}},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4,n=function(){},i=new Promise((function(e,t){n=function(){t("timeout promise")}})),o=Promise.race([e,i]);return setTimeout((function(){n()}),t),o},a=function(e){Object(i.a)(r,e);var n=Object(o.a)(r);function r(){return Object(t.a)(this,r),n.apply(this,arguments)}return r}(r.Component);a.getRequest=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(fetch(s(e)(t),{method:"GET",headers:c()})).then((function(e){if(e.ok)return e.json();401===e.status&&(console.log("getRequest",e),alert("\u8bf7\u91cd\u65b0\u767b\u5f55\uff01"))})).then((function(e){return e||e})).catch((function(e){console.log("getRequesterror",e)}))},a.postRequrst=function(e,t){return u(fetch(e,{method:"POST",headers:{},body:t})).then((function(e){if(e.ok)return e.json();alert("\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff1b\r\nCode:"+e.status)})).then((function(e){return e&&e.code,e})).catch((function(e){alert(e)}))},a.deleteRequerst=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(fetch(s(e)(t),{method:"DELETE",headers:c()})).then((function(e){if(e.ok)return e.json();console.log("\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff1b\r\nCode:",e)})).then((function(e){return e&&e.code,e})).catch((function(e){console.log("postRequrst",e)}))},a.getFileRequest=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(fetch(s(t)(n),{method:"GET",responseType:"blob",headers:{Authorization:"BasicAuth "+e.Value.Token}})).then((function(e){if(e.ok)return e.blob();console.log("getRequest",e)})).catch((function(e){console.log("getRequesterror",e)}))}}).call(this,n(24))},410:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var i=n(49),o=n(50),r=n(10),c=n(123),s=n.n(c),u=(n(1042),n(1133)),a=n(71),l=n(52),h=n(51),d=n(195),f=n.n(d),p=n(1140),v=(n(1044),n(675),n(1045),n(23)),m=null,b=null,g=(window.config,function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).levelmanagerclick=function(){f()("#levellist").toggle()},o.primitiveChanged=function(e){var t=o.state.url,n=o.primitiveHasLoaded(t);if(null==n){if(1==e){console.log(t);var i=new b.Cesium3DTileset({url:t});m.scene.primitives.add(i).readyPromise.then((function(){var e=i.boundingSphere;m.camera.flyToBoundingSphere(e,{orientation:{direction:m.camera.direction,up:m.camera.up}})}))}}else n.show=!n.show},o.primitiveHasLoaded=function(e){for(var t=0;t<m.scene.primitives.length;t++){var n=m.scene.primitives._primitives[t];if(n.url&&n.url==e)return n}return null},m=o.props.viewer,b=o.props.cesium,o.isLoad3DLayers=!1,o.primitiveChanged=o.primitiveChanged.bind(Object(a.a)(o)),o.state={checkedKeys:[],treeData:[],type:"",url:""},o}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=window.location.search.split("&");if(t.length>1){var n=t[0].split("=")[1],i=t[1].split("=")[1],o=t[2].split("=")[1]+":"+n+"/"+i+"/tileset.json";this.setState({treeData:[{title:"\u56fe\u5c42\u540d",key:"1",checkable:!0}],checkedKeys:["1"],type:"OSGB",url:o},(function(){e.primitiveChanged(!0)}))}}},{key:"render",value:function(){var e=this;return Object(v.jsxs)(r.Fragment,{children:[Object(v.jsx)("div",{className:"cesium-button cesium-toolbar-button",style:{fontSize:"26px"},onClick:this.levelmanagerclick.bind(this),children:Object(v.jsx)(p.a,{style:{verticalAlign:"text-top",paddingLeft:"2px"}})}),Object(v.jsx)("div",{id:"levellist",className:"bf-scroll-bar",children:Object(v.jsx)(u.a,{checkable:!0,checkedKeys:this.state.checkedKeys,onCheck:function(t,n){switch(e.state.type){case"OSGB":e.primitiveChanged(n.checked)}e.setState({checkedKeys:t})},treeData:this.state.treeData})})]})}}]),n}(r.Component)),j=function(){function e(t,n,o){Object(i.a)(this,e),this.viewer=t,this.cesium=n,this.LevelManagerComponent=null}return Object(o.a)(e,[{key:"load",value:function(){var e=f()(".cesium-viewer-toolbar")[0],t="leveldiv",n="<div id=".concat(t,' style="display:inline-block"></div>');return f()(e).append(n),this.LevelManagerComponent=s.a.render(Object(v.jsx)(g,{viewer:this.viewer,cesium:this.cesium}),document.getElementById(t)),!0}}]),e}()},675:function(e,t,n){(function(e){e.Value={Viewer:null,Cesium:null}}).call(this,n(24))}}]);